<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRIFORTIS · Schiavinato Sharing (Air-Gapped)</title>
    <!--
        This single-file tool intentionally embeds every asset (styles + scripts)
        so that it can run air-gapped. No external fonts, CDNs, or network calls
        are used anywhere in this document. The styling below reuses the GRIFORTIS
        design language defined in Exemplo_Form.html and extends it with the UI
        patterns required for the sharding/recovery workflows.
    -->
    <style>
        :root {
            --brand-navy: #0B1019;
            --brand-titanium: #E3E4E6;
            --cyber-gold: #F4B400;
            --error-red: #FF4444;
            --success-green: #00E676;

            --bg-main: var(--brand-navy);
            --bg-card: #151E2E;
            --text-main: var(--brand-titanium);
            --text-muted: #8A8D91;
            --border-color: #2C3E50;
            --input-bg: rgba(0,0,0,0.35);
            --input-text: #fff;
            --shadow-color: rgba(0,0,0,0.45);
            --btn-disabled-bg: #2C3E50;
            --btn-disabled-text: #586376;
            --btn-cancel-border: #4A5568;
            --alert-error-bg: #3b1f1f;
            --alert-error-border: #7a2c2c;
            --alert-error-text: #fecaca;
            --alert-success-bg: #113a29;
            --alert-success-border: #1a6445;
            --alert-success-text: #bbf7d0;
            --debug-bg: #2f1155;
            color-scheme: dark;
        }

        [data-theme="light"] {
            --bg-main: #F0F2F5;
            --bg-card: #FFFFFF;
            --text-main: #0B1019;
            --text-muted: #5E6C84;
            --border-color: #D1D5DB;
            --input-bg: #F7F9FC;
            --input-text: #0B1019;
            --shadow-color: rgba(0,0,0,0.1);
            --btn-disabled-bg: #E2E8F0;
            --btn-disabled-text: #A0AEC0;
            --btn-cancel-border: #CBD5E0;
            --alert-error-bg: #FEEEEE;
            --alert-error-border: #FCA5A5;
            --alert-error-text: #7f1d1d;
            --alert-success-bg: #E6F8F2;
            --alert-success-border: #6EE7B7;
            --alert-success-text: #064e3b;
            --debug-bg: #fff7d6;
            color-scheme: light;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background-color: var(--bg-main);
            color: var(--text-main);
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            font-weight: 400;
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
            min-height: 100vh;
        }

        h1, h2, h3, h4 {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            font-weight: 800;
            text-transform: uppercase;
            color: var(--text-main);
            letter-spacing: 0.5px;
            margin-bottom: 0.5em;
        }
        h1 { font-size: 2rem; }
        h2 { font-size: 1.5rem; margin-top: 1.5em; }
        h3 { font-size: 1.25rem; font-weight: 700; margin-top: 1.25em; }
        h4 { font-size: 1rem; font-weight: 700; margin-top: 1em; }

        p, ul, ol { margin-bottom: 1em; }
        code, .mono {
            font-family: "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
            background: var(--input-bg);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .container {
            width: 100%;
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            padding: 20px 0;
            margin-bottom: 30px;
            gap: 1rem;
        }

        .header h1 {
            margin: 0;
            background: -webkit-linear-gradient(45deg, var(--text-main), var(--text-muted));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .theme-toggle {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            padding: 8px 16px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .language-select-label {
            display: flex;
            flex-direction: column;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .language-select-label select {
            margin-top: 0.35rem;
            padding: 0.45rem 0.75rem;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background: var(--input-bg);
            color: var(--input-text);
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .component-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 28px;
            box-shadow: 0 4px 20px var(--shadow-color);
            margin-bottom: 30px;
        }

        .section-heading {
            margin-bottom: 1.5rem;
        }

        .tagline {
            font-size: 0.95rem;
            color: var(--text-muted);
            text-transform: none;
            letter-spacing: normal;
            font-weight: 600;
        }

        .list-pill {
            margin-bottom: 0.75rem;
            padding-left: 1.2rem;
            position: relative;
        }

        .list-pill::before {
            content: "•";
            position: absolute;
            left: 0;
            color: var(--cyber-gold);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 0.35rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        input[type="text"],
        input[type="date"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--input-text);
            font-family: "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
            font-size: 0.95rem;
            transition: border 0.3s ease, box-shadow 0.3s ease;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--cyber-gold);
            box-shadow: 0 0 0 2px rgba(244, 180, 0, 0.25);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 6px;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            font-weight: 800;
            font-size: 0.9rem;
            text-transform: uppercase;
            cursor: pointer;
            border: none;
            transition: transform 0.2s ease, filter 0.2s ease;
        }

        .btn-primary {
            background-color: var(--cyber-gold);
            color: #000;
            box-shadow: 0 4px 15px rgba(244, 180, 0, 0.2);
        }

        .btn-primary:not(:disabled):hover {
            transform: translateY(-2px);
            filter: brightness(1.05);
        }

        .btn-primary:disabled {
            background-color: var(--btn-disabled-bg);
            color: var(--btn-disabled-text);
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn-secondary {
            background-color: transparent;
            border: 1px solid var(--btn-cancel-border);
            color: var(--text-muted);
        }

        .btn-secondary:hover {
            border-color: var(--text-main);
            color: var(--text-main);
        }

        .alert-region {
            margin-top: 1rem;
        }

        .alert {
            padding: 0.85rem 1rem;
            border-radius: 8px;
            border: 1px solid transparent;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        .alert-success {
            background-color: var(--alert-success-bg);
            border-color: var(--alert-success-border);
            color: var(--alert-success-text);
        }

        .alert-error {
            background-color: var(--alert-error-bg);
            border-color: var(--alert-error-border);
            color: var(--alert-error-text);
        }

        .share-card {
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(0,0,0,0.15);
        }

        [data-theme="light"] .share-card {
            background: rgba(11,16,25,0.03);
        }

        .share-card-header {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .share-card-header h3 {
            margin: 0;
            font-size: 1rem;
        }

        table.share-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0.5rem;
        }

        table.share-table thead th {
            text-align: left;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.4rem;
        }

        table.share-table tbody td {
            padding: 0.6rem 0.2rem;
            border-bottom: 1px dashed var(--border-color);
            vertical-align: top;
        }

        .value-pill {
            font-family: "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
            font-size: 0.85rem;
            background: rgba(0,0,0,0.25);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 0.2rem;
        }

        [data-theme="light"] .value-pill {
            background: rgba(0,0,0,0.07);
        }

        .mnemonic-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            display: block;
        }

        .debug-section {
            background: var(--debug-bg);
            border: 1px dashed var(--cyber-gold);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1.5rem;
        }

        .debug-section h3 {
            color: var(--error-red);
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .debug-section pre {
            max-height: 240px;
            overflow: auto;
            background: rgba(0,0,0,0.25);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .recovery-share-card {
            border: 1px dashed var(--border-color);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            background: rgba(0,0,0,0.08);
        }

        [data-theme="light"] .recovery-share-card {
            background: rgba(0,0,0,0.02);
        }

        .recovery-share-card h4 {
            margin-top: 0;
            text-transform: none;
        }

        .recovery-textarea {
            min-height: 100px;
            font-size: 0.85rem;
        }

        .mnemonic-output {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.65rem;
            margin-top: 1rem;
        }

        .mnemonic-word {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.6rem;
            text-align: center;
            font-family: "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
            background: rgba(0,0,0,0.15);
        }

        [data-theme="light"] .mnemonic-word {
            background: rgba(11,16,25,0.04);
        }

        .disclaimer {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin: 2rem 0;
            border-top: 1px solid var(--border-color);
            padding-top: 1.2rem;
            text-align: center;
        }

        .hidden {
            display: none !important;
        }

        .print-note {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        @media print {
            body {
                background: #fff;
                color: #000;
            }
            .component-card,
            .header,
            .theme-toggle,
            .language-select-label,
            #shardingForm,
            #recoveryCard,
            #diagnosticsCard,
            #debugCoefficientsSection {
                display: none;
            }
            #shareResults {
                display: block;
            }
            .share-card {
                page-break-inside: avoid;
                background: #fff;
                color: #000;
                border-color: #000;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div>
                <h1 data-i18n="header.title">Schiavinato Sharing · Offline</h1>
                <p class="tagline" data-i18n="header.tagline">Human-auditable secret sharing for mnemonic inheritance.</p>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" id="themeToggle" type="button">
                    <span id="toggle-icon">☀️</span>
                    <span id="toggle-text" data-i18n="header.themeToggle.light">Light Mode</span>
                </button>
                <label class="language-select-label">
                    <span data-i18n="header.language">Language</span>
                    <select id="languageSelect">
                        <option value="en">English</option>
                    </select>
                </label>
            </div>
        </header>

        <main>
            <section class="component-card" id="safetyCard">
                <h2 data-i18n="safety.heading">Operational Safety &amp; Warnings</h2>
                <p data-i18n="safety.intro">
                    This file is meant to run on an air-gapped computer. Verify its checksum, disconnect networking,
                    and only then open it. A single share is never a wallet; keep worksheets physically separated.
                </p>
                <ul>
                    <li class="list-pill" data-i18n="safety.item1">Never connect this file to the internet while entering secrets.</li>
                    <li class="list-pill" data-i18n="safety.item2">Do not email, photograph, or cloud-sync generated worksheets.</li>
                    <li class="list-pill" data-i18n="safety.item3">Store shares in distinct physical locations so no single incident compromises the wallet.</li>
                    <li class="list-pill" data-i18n="safety.item4">During recovery, verify every row checksum and the master verification number before typing the mnemonic anywhere.</li>
                </ul>
            </section>

            <section class="component-card" id="shardingCard">
                <div class="section-heading">
                    <h2 data-i18n="sharding.heading">Automated Sharding</h2>
                    <p data-i18n="sharding.intro">
                        Enter an existing BIP39 mnemonic, choose a threshold scheme, and generate printable worksheets.
                        This tool supports 12-word and 24-word phrases. All math happens in GF(2053) as described in the whitepaper.
                    </p>
                </div>
                <form id="shardingForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="walletName" data-i18n="sharding.walletName">Wallet Identifier</label>
                            <input type="text" id="walletName" placeholder="e.g., Family Vault A">
                        </div>
                        <div class="form-group">
                            <label for="creationDate" data-i18n="sharding.creationDate">Creation Date</label>
                            <input type="date" id="creationDate">
                        </div>
                        <div class="form-group">
                            <label for="mnemonicLength" data-i18n="sharding.mnemonicLength">Mnemonic Length</label>
                            <select id="mnemonicLength">
                                <option value="12">12 words</option>
                                <option value="24" selected>24 words</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="schemeSelect" data-i18n="sharding.scheme">Threshold Scheme</label>
                            <select id="schemeSelect">
                                <option value="2-3">2-of-3</option>
                                <option value="2-4">2-of-4</option>
                                <option value="3-5">3-of-5</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="mnemonicInput" data-i18n="sharding.mnemonicInputLabel">BIP39 Mnemonic</label>
                        <textarea id="mnemonicInput" placeholder="Enter 12 or 24 lowercase words separated by spaces."></textarea>
                    </div>
                    <div class="btn-row">
                        <button type="submit" class="btn btn-primary" data-i18n="sharding.generateBtn">Generate Worksheets</button>
                        <button type="button" class="btn btn-secondary" id="printButton" disabled data-i18n="sharding.printBtn">Print Worksheets</button>
                    </div>
                    <p class="print-note" data-i18n="sharding.printNote">
                        Printing only becomes available after a successful generation. Use a printer that does not store copies of the pages.
                    </p>
                </form>
                <div id="shardingMessages" class="alert-region"></div>
                <div id="shareResults"></div>
            </section>

            <section class="component-card" id="recoveryCard">
                <div class="section-heading">
                    <h2 data-i18n="recovery.heading">Automated Recovery</h2>
                    <p data-i18n="recovery.intro">
                        Gather at least k worksheets, transcribe their numeric values, and let this section reconstruct
                        the mnemonic. Every row checksum and the master verification number are re-checked before
                        revealing the phrase. This workflow also adapts to 12 or 24 words.
                    </p>
                </div>
                <form id="recoveryForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="recoveryMnemonicLength" data-i18n="recovery.mnemonicLength">Mnemonic Length</label>
                            <select id="recoveryMnemonicLength">
                                <option value="12">12 words</option>
                                <option value="24" selected>24 words</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="recoverySchemeSelect" data-i18n="recovery.scheme">Threshold Scheme</label>
                            <select id="recoverySchemeSelect">
                                <option value="2-3">2-of-3</option>
                                <option value="2-4">2-of-4</option>
                                <option value="3-5">3-of-5</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="recoveryShareCount" data-i18n="recovery.shareCount">Shares Entered</label>
                            <select id="recoveryShareCount">
                                <option value="2">2</option>
                                <option value="3" selected>3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                    </div>
                    <p data-i18n="recovery.instructions">
                        For each share, copy the numeric values row by row. Use spaces or commas between the four numbers
                        on each row (three word shares + checksum share). The master verification share is provided separately.
                    </p>
                    <div class="btn-row">
                        <button type="submit" class="btn btn-primary" data-i18n="recovery.recoverBtn">Recover Mnemonic</button>
                        <button type="button" class="btn btn-secondary" id="clearRecoveryBtn" data-i18n="recovery.clearBtn">Clear Inputs</button>
                    </div>
                </form>
                <div id="recoverySharesContainer"></div>
                <div id="recoveryMessages" class="alert-region"></div>
                <div id="recoveredMnemonic"></div>
            </section>

            <section class="component-card" id="diagnosticsCard">
                <h2 data-i18n="diagnostics.heading">Diagnostics &amp; Self-Test</h2>
                <p data-i18n="diagnostics.intro">
                    This optional section helps developers audit the arithmetic. Run the self-test to verify that
                    GF(2053) operations, polynomial evaluation, and interpolation remain sound on this build.
                    No wallet secrets are used during the self-test.
                </p>
                <div class="btn-row">
                    <button type="button" class="btn btn-secondary" id="runSelfTestBtn" data-i18n="diagnostics.runBtn">Run Self-Test</button>
                    <button type="button" class="btn btn-secondary" id="toggleDebugBtn" data-i18n="diagnostics.toggleDebugBtn">Toggle Debug Coefficients</button>
                </div>
                <pre id="selfTestOutput" class="mono"></pre>
            </section>

            <section class="component-card debug-section hidden" id="debugCoefficientsSection">
                <h2 data-i18n="debug.heading">TEMPORARY – DEBUG ONLY</h2>
                <p data-i18n="debug.description">
                    The following table lists every random polynomial used for the most recent sharding run.
                    Do not share or print this data in production. It exists solely to aid development and auditing.
                </p>
                <div id="debugCoefficients"></div>
            </section>
        </main>

        <footer class="disclaimer">
            <p data-i18n="footer.disclaimer">
                GRIFORTIS provides software only. You remain responsible for operational security, legal compliance,
                and custody outcomes. Keep your shares offline and periodically rehearse recovery procedures.
            </p>
        </footer>
    </div>

    <script>
        (function () {
            "use strict";

            /**
             * All user-facing strings are stored here for future multi-language support.
             * Add new keys as needed and keep their usage consistent.
             */
            const LOCALES = {
                en: {
                    "header.title": "Schiavinato Sharing · Offline",
                    "header.tagline": "Human-auditable secret sharing for mnemonic inheritance.",
                    "header.themeToggle.light": "Light Mode",
                    "header.themeToggle.dark": "Dark Mode",
                    "header.language": "Language",
                    "safety.heading": "Operational Safety & Warnings",
                    "safety.intro": "This file is meant to run on an air-gapped computer. Verify its checksum, disconnect networking, and only then open it. A single share is never a wallet; keep worksheets physically separated.",
                    "safety.item1": "Never connect this file to the internet while entering secrets.",
                    "safety.item2": "Do not email, photograph, or cloud-sync generated worksheets.",
                    "safety.item3": "Store shares in distinct physical locations so no single incident compromises the wallet.",
                    "safety.item4": "During recovery, verify every row checksum and the master verification number before typing the mnemonic anywhere.",
                    "sharding.heading": "Automated Sharding",
                    "sharding.intro": "Enter an existing BIP39 mnemonic, choose a threshold scheme, and generate printable worksheets. This tool supports 12-word and 24-word phrases. All math happens in GF(2053).",
                    "sharding.walletName": "Wallet Identifier",
                    "sharding.creationDate": "Creation Date",
                    "sharding.mnemonicLength": "Mnemonic Length",
                    "sharding.scheme": "Threshold Scheme",
                    "sharding.mnemonicInputLabel": "BIP39 Mnemonic",
                    "sharding.generateBtn": "Generate Worksheets",
                    "sharding.printBtn": "Print Worksheets",
                    "sharding.printNote": "Printing only becomes available after a successful generation. Use a printer that does not store copies of the pages.",
                    "recovery.heading": "Automated Recovery",
                    "recovery.intro": "Gather at least k worksheets, transcribe their numeric values, and reconstruct the mnemonic. Every checksum is verified before revealing the phrase.",
                    "recovery.mnemonicLength": "Mnemonic Length",
                    "recovery.scheme": "Threshold Scheme",
                    "recovery.shareCount": "Shares Entered",
                    "recovery.instructions": "For each share, copy the numeric values row by row. Use spaces or commas between the four numbers on each row (three word shares + checksum share). The master verification share is provided separately.",
                    "recovery.recoverBtn": "Recover Mnemonic",
                    "recovery.clearBtn": "Clear Inputs",
                    "diagnostics.heading": "Diagnostics & Self-Test",
                    "diagnostics.intro": "Optional tooling for auditors. Run the self-test to ensure arithmetic routines behave as expected. Secrets are never touched during this process.",
                    "diagnostics.runBtn": "Run Self-Test",
                    "diagnostics.toggleDebugBtn": "Toggle Debug Coefficients",
                    "debug.heading": "TEMPORARY – DEBUG ONLY",
                    "debug.description": "The following table lists every random polynomial used for the most recent sharding run. Do not share or print this data in production.",
                    "footer.disclaimer": "GRIFORTIS provides software only. You remain responsible for operational security, legal compliance, and custody outcomes. Keep your shares offline and rehearse recovery procedures frequently."
                }
            };

            const PRIME = 2053;
            const DEFAULT_LOCALE = "en";
            const SCHEMES = {
                "2-3": { threshold: 2, total: 3 },
                "2-4": { threshold: 2, total: 4 },
                "3-5": { threshold: 3, total: 5 }
            };

            /**
             * The BIP39 English wordlist should be injected into window.GRIFORTIS_BIP39_WORDLIST.
             */
            const BUILTIN_BIP39_WORDLIST = [
            "abandon",
                "ability",
                "able",
                "about",
                "above",
                "absent",
                "absorb",
                "abstract",
                "absurd",
                "abuse",
                "access",
                "accident",
                "account",
                "accuse",
                "achieve",
                "acid",
                "acoustic",
                "acquire",
                "across",
                "act",
                "action",
                "actor",
                "actress",
                "actual",
                "adapt",
                "add",
                "addict",
                "address",
                "adjust",
                "admit",
                "adult",
                "advance",
                "advice",
                "aerobic",
                "affair",
                "afford",
                "afraid",
                "again",
                "age",
                "agent",
                "agree",
                "ahead",
                "aim",
                "air",
                "airport",
                "aisle",
                "alarm",
                "album",
                "alcohol",
                "alert",
                "alien",
                "all",
                "alley",
                "allow",
                "almost",
                "alone",
                "alpha",
                "already",
                "also",
                "alter",
                "always",
                "amateur",
                "amazing",
                "among",
                "amount",
                "amused",
                "analyst",
                "anchor",
                "ancient",
                "anger",
                "angle",
                "angry",
                "animal",
                "ankle",
                "announce",
                "annual",
                "another",
                "answer",
                "antenna",
                "antique",
                "anxiety",
                "any",
                "apart",
                "apology",
                "appear",
                "apple",
                "approve",
                "april",
                "arch",
                "arctic",
                "area",
                "arena",
                "argue",
                "arm",
                "armed",
                "armor",
                "army",
                "around",
                "arrange",
                "arrest",
                "arrive",
                "arrow",
                "art",
                "artefact",
                "artist",
                "artwork",
                "ask",
                "aspect",
                "assault",
                "asset",
                "assist",
                "assume",
                "asthma",
                "athlete",
                "atom",
                "attack",
                "attend",
                "attitude",
                "attract",
                "auction",
                "audit",
                "august",
                "aunt",
                "author",
                "auto",
                "autumn",
                "average",
                "avocado",
                "avoid",
                "awake",
                "aware",
                "away",
                "awesome",
                "awful",
                "awkward",
                "axis",
                "baby",
                "bachelor",
                "bacon",
                "badge",
                "bag",
                "balance",
                "balcony",
                "ball",
                "bamboo",
                "banana",
                "banner",
                "bar",
                "barely",
                "bargain",
                "barrel",
                "base",
                "basic",
                "basket",
                "battle",
                "beach",
                "bean",
                "beauty",
                "because",
                "become",
                "beef",
                "before",
                "begin",
                "behave",
                "behind",
                "believe",
                "below",
                "belt",
                "bench",
                "benefit",
                "best",
                "betray",
                "better",
                "between",
                "beyond",
                "bicycle",
                "bid",
                "bike",
                "bind",
                "biology",
                "bird",
                "birth",
                "bitter",
                "black",
                "blade",
                "blame",
                "blanket",
                "blast",
                "bleak",
                "bless",
                "blind",
                "blood",
                "blossom",
                "blouse",
                "blue",
                "blur",
                "blush",
                "board",
                "boat",
                "body",
                "boil",
                "bomb",
                "bone",
                "bonus",
                "book",
                "boost",
                "border",
                "boring",
                "borrow",
                "boss",
                "bottom",
                "bounce",
                "box",
                "boy",
                "bracket",
                "brain",
                "brand",
                "brass",
                "brave",
                "bread",
                "breeze",
                "brick",
                "bridge",
                "brief",
                "bright",
                "bring",
                "brisk",
                "broccoli",
                "broken",
                "bronze",
                "broom",
                "brother",
                "brown",
                "brush",
                "bubble",
                "buddy",
                "budget",
                "buffalo",
                "build",
                "bulb",
                "bulk",
                "bullet",
                "bundle",
                "bunker",
                "burden",
                "burger",
                "burst",
                "bus",
                "business",
                "busy",
                "butter",
                "buyer",
                "buzz",
                "cabbage",
                "cabin",
                "cable",
                "cactus",
                "cage",
                "cake",
                "call",
                "calm",
                "camera",
                "camp",
                "can",
                "canal",
                "cancel",
                "candy",
                "cannon",
                "canoe",
                "canvas",
                "canyon",
                "capable",
                "capital",
                "captain",
                "car",
                "carbon",
                "card",
                "cargo",
                "carpet",
                "carry",
                "cart",
                "case",
                "cash",
                "casino",
                "castle",
                "casual",
                "cat",
                "catalog",
                "catch",
                "category",
                "cattle",
                "caught",
                "cause",
                "caution",
                "cave",
                "ceiling",
                "celery",
                "cement",
                "census",
                "century",
                "cereal",
                "certain",
                "chair",
                "chalk",
                "champion",
                "change",
                "chaos",
                "chapter",
                "charge",
                "chase",
                "chat",
                "cheap",
                "check",
                "cheese",
                "chef",
                "cherry",
                "chest",
                "chicken",
                "chief",
                "child",
                "chimney",
                "choice",
                "choose",
                "chronic",
                "chuckle",
                "chunk",
                "churn",
                "cigar",
                "cinnamon",
                "circle",
                "citizen",
                "city",
                "civil",
                "claim",
                "clap",
                "clarify",
                "claw",
                "clay",
                "clean",
                "clerk",
                "clever",
                "click",
                "client",
                "cliff",
                "climb",
                "clinic",
                "clip",
                "clock",
                "clog",
                "close",
                "cloth",
                "cloud",
                "clown",
                "club",
                "clump",
                "cluster",
                "clutch",
                "coach",
                "coast",
                "coconut",
                "code",
                "coffee",
                "coil",
                "coin",
                "collect",
                "color",
                "column",
                "combine",
                "come",
                "comfort",
                "comic",
                "common",
                "company",
                "concert",
                "conduct",
                "confirm",
                "congress",
                "connect",
                "consider",
                "control",
                "convince",
                "cook",
                "cool",
                "copper",
                "copy",
                "coral",
                "core",
                "corn",
                "correct",
                "cost",
                "cotton",
                "couch",
                "country",
                "couple",
                "course",
                "cousin",
                "cover",
                "coyote",
                "crack",
                "cradle",
                "craft",
                "cram",
                "crane",
                "crash",
                "crater",
                "crawl",
                "crazy",
                "cream",
                "credit",
                "creek",
                "crew",
                "cricket",
                "crime",
                "crisp",
                "critic",
                "crop",
                "cross",
                "crouch",
                "crowd",
                "crucial",
                "cruel",
                "cruise",
                "crumble",
                "crunch",
                "crush",
                "cry",
                "crystal",
                "cube",
                "culture",
                "cup",
                "cupboard",
                "curious",
                "current",
                "curtain",
                "curve",
                "cushion",
                "custom",
                "cute",
                "cycle",
                "dad",
                "damage",
                "damp",
                "dance",
                "danger",
                "daring",
                "dash",
                "daughter",
                "dawn",
                "day",
                "deal",
                "debate",
                "debris",
                "decade",
                "december",
                "decide",
                "decline",
                "decorate",
                "decrease",
                "deer",
                "defense",
                "define",
                "defy",
                "degree",
                "delay",
                "deliver",
                "demand",
                "demise",
                "denial",
                "dentist",
                "deny",
                "depart",
                "depend",
                "deposit",
                "depth",
                "deputy",
                "derive",
                "describe",
                "desert",
                "design",
                "desk",
                "despair",
                "destroy",
                "detail",
                "detect",
                "develop",
                "device",
                "devote",
                "diagram",
                "dial",
                "diamond",
                "diary",
                "dice",
                "diesel",
                "diet",
                "differ",
                "digital",
                "dignity",
                "dilemma",
                "dinner",
                "dinosaur",
                "direct",
                "dirt",
                "disagree",
                "discover",
                "disease",
                "dish",
                "dismiss",
                "disorder",
                "display",
                "distance",
                "divert",
                "divide",
                "divorce",
                "dizzy",
                "doctor",
                "document",
                "dog",
                "doll",
                "dolphin",
                "domain",
                "donate",
                "donkey",
                "donor",
                "door",
                "dose",
                "double",
                "dove",
                "draft",
                "dragon",
                "drama",
                "drastic",
                "draw",
                "dream",
                "dress",
                "drift",
                "drill",
                "drink",
                "drip",
                "drive",
                "drop",
                "drum",
                "dry",
                "duck",
                "dumb",
                "dune",
                "during",
                "dust",
                "dutch",
                "duty",
                "dwarf",
                "dynamic",
                "eager",
                "eagle",
                "early",
                "earn",
                "earth",
                "easily",
                "east",
                "easy",
                "echo",
                "ecology",
                "economy",
                "edge",
                "edit",
                "educate",
                "effort",
                "egg",
                "eight",
                "either",
                "elbow",
                "elder",
                "electric",
                "elegant",
                "element",
                "elephant",
                "elevator",
                "elite",
                "else",
                "embark",
                "embody",
                "embrace",
                "emerge",
                "emotion",
                "employ",
                "empower",
                "empty",
                "enable",
                "enact",
                "end",
                "endless",
                "endorse",
                "enemy",
                "energy",
                "enforce",
                "engage",
                "engine",
                "enhance",
                "enjoy",
                "enlist",
                "enough",
                "enrich",
                "enroll",
                "ensure",
                "enter",
                "entire",
                "entry",
                "envelope",
                "episode",
                "equal",
                "equip",
                "era",
                "erase",
                "erode",
                "erosion",
                "error",
                "erupt",
                "escape",
                "essay",
                "essence",
                "estate",
                "eternal",
                "ethics",
                "evidence",
                "evil",
                "evoke",
                "evolve",
                "exact",
                "example",
                "excess",
                "exchange",
                "excite",
                "exclude",
                "excuse",
                "execute",
                "exercise",
                "exhaust",
                "exhibit",
                "exile",
                "exist",
                "exit",
                "exotic",
                "expand",
                "expect",
                "expire",
                "explain",
                "expose",
                "express",
                "extend",
                "extra",
                "eye",
                "eyebrow",
                "fabric",
                "face",
                "faculty",
                "fade",
                "faint",
                "faith",
                "fall",
                "FALSE",
                "fame",
                "family",
                "famous",
                "fan",
                "fancy",
                "fantasy",
                "farm",
                "fashion",
                "fat",
                "fatal",
                "father",
                "fatigue",
                "fault",
                "favorite",
                "feature",
                "february",
                "federal",
                "fee",
                "feed",
                "feel",
                "female",
                "fence",
                "festival",
                "fetch",
                "fever",
                "few",
                "fiber",
                "fiction",
                "field",
                "figure",
                "file",
                "film",
                "filter",
                "final",
                "find",
                "fine",
                "finger",
                "finish",
                "fire",
                "firm",
                "first",
                "fiscal",
                "fish",
                "fit",
                "fitness",
                "fix",
                "flag",
                "flame",
                "flash",
                "flat",
                "flavor",
                "flee",
                "flight",
                "flip",
                "float",
                "flock",
                "floor",
                "flower",
                "fluid",
                "flush",
                "fly",
                "foam",
                "focus",
                "fog",
                "foil",
                "fold",
                "follow",
                "food",
                "foot",
                "force",
                "forest",
                "forget",
                "fork",
                "fortune",
                "forum",
                "forward",
                "fossil",
                "foster",
                "found",
                "fox",
                "fragile",
                "frame",
                "frequent",
                "fresh",
                "friend",
                "fringe",
                "frog",
                "front",
                "frost",
                "frown",
                "frozen",
                "fruit",
                "fuel",
                "fun",
                "funny",
                "furnace",
                "fury",
                "future",
                "gadget",
                "gain",
                "galaxy",
                "gallery",
                "game",
                "gap",
                "garage",
                "garbage",
                "garden",
                "garlic",
                "garment",
                "gas",
                "gasp",
                "gate",
                "gather",
                "gauge",
                "gaze",
                "general",
                "genius",
                "genre",
                "gentle",
                "genuine",
                "gesture",
                "ghost",
                "giant",
                "gift",
                "giggle",
                "ginger",
                "giraffe",
                "girl",
                "give",
                "glad",
                "glance",
                "glare",
                "glass",
                "glide",
                "glimpse",
                "globe",
                "gloom",
                "glory",
                "glove",
                "glow",
                "glue",
                "goat",
                "goddess",
                "gold",
                "good",
                "goose",
                "gorilla",
                "gospel",
                "gossip",
                "govern",
                "gown",
                "grab",
                "grace",
                "grain",
                "grant",
                "grape",
                "grass",
                "gravity",
                "great",
                "green",
                "grid",
                "grief",
                "grit",
                "grocery",
                "group",
                "grow",
                "grunt",
                "guard",
                "guess",
                "guide",
                "guilt",
                "guitar",
                "gun",
                "gym",
                "habit",
                "hair",
                "half",
                "hammer",
                "hamster",
                "hand",
                "happy",
                "harbor",
                "hard",
                "harsh",
                "harvest",
                "hat",
                "have",
                "hawk",
                "hazard",
                "head",
                "health",
                "heart",
                "heavy",
                "hedgehog",
                "height",
                "hello",
                "helmet",
                "help",
                "hen",
                "hero",
                "hidden",
                "high",
                "hill",
                "hint",
                "hip",
                "hire",
                "history",
                "hobby",
                "hockey",
                "hold",
                "hole",
                "holiday",
                "hollow",
                "home",
                "honey",
                "hood",
                "hope",
                "horn",
                "horror",
                "horse",
                "hospital",
                "host",
                "hotel",
                "hour",
                "hover",
                "hub",
                "huge",
                "human",
                "humble",
                "humor",
                "hundred",
                "hungry",
                "hunt",
                "hurdle",
                "hurry",
                "hurt",
                "husband",
                "hybrid",
                "ice",
                "icon",
                "idea",
                "identify",
                "idle",
                "ignore",
                "ill",
                "illegal",
                "illness",
                "image",
                "imitate",
                "immense",
                "immune",
                "impact",
                "impose",
                "improve",
                "impulse",
                "inch",
                "include",
                "income",
                "increase",
                "index",
                "indicate",
                "indoor",
                "industry",
                "infant",
                "inflict",
                "inform",
                "inhale",
                "inherit",
                "initial",
                "inject",
                "injury",
                "inmate",
                "inner",
                "innocent",
                "input",
                "inquiry",
                "insane",
                "insect",
                "inside",
                "inspire",
                "install",
                "intact",
                "interest",
                "into",
                "invest",
                "invite",
                "involve",
                "iron",
                "island",
                "isolate",
                "issue",
                "item",
                "ivory",
                "jacket",
                "jaguar",
                "jar",
                "jazz",
                "jealous",
                "jeans",
                "jelly",
                "jewel",
                "job",
                "join",
                "joke",
                "journey",
                "joy",
                "judge",
                "juice",
                "jump",
                "jungle",
                "junior",
                "junk",
                "just",
                "kangaroo",
                "keen",
                "keep",
                "ketchup",
                "key",
                "kick",
                "kid",
                "kidney",
                "kind",
                "kingdom",
                "kiss",
                "kit",
                "kitchen",
                "kite",
                "kitten",
                "kiwi",
                "knee",
                "knife",
                "knock",
                "know",
                "lab",
                "label",
                "labor",
                "ladder",
                "lady",
                "lake",
                "lamp",
                "language",
                "laptop",
                "large",
                "later",
                "latin",
                "laugh",
                "laundry",
                "lava",
                "law",
                "lawn",
                "lawsuit",
                "layer",
                "lazy",
                "leader",
                "leaf",
                "learn",
                "leave",
                "lecture",
                "left",
                "leg",
                "legal",
                "legend",
                "leisure",
                "lemon",
                "lend",
                "length",
                "lens",
                "leopard",
                "lesson",
                "letter",
                "level",
                "liar",
                "liberty",
                "library",
                "license",
                "life",
                "lift",
                "light",
                "like",
                "limb",
                "limit",
                "link",
                "lion",
                "liquid",
                "list",
                "little",
                "live",
                "lizard",
                "load",
                "loan",
                "lobster",
                "local",
                "lock",
                "logic",
                "lonely",
                "long",
                "loop",
                "lottery",
                "loud",
                "lounge",
                "love",
                "loyal",
                "lucky",
                "luggage",
                "lumber",
                "lunar",
                "lunch",
                "luxury",
                "lyrics",
                "machine",
                "mad",
                "magic",
                "magnet",
                "maid",
                "mail",
                "main",
                "major",
                "make",
                "mammal",
                "man",
                "manage",
                "mandate",
                "mango",
                "mansion",
                "manual",
                "maple",
                "marble",
                "march",
                "margin",
                "marine",
                "market",
                "marriage",
                "mask",
                "mass",
                "master",
                "match",
                "material",
                "math",
                "matrix",
                "matter",
                "maximum",
                "maze",
                "meadow",
                "mean",
                "measure",
                "meat",
                "mechanic",
                "medal",
                "media",
                "melody",
                "melt",
                "member",
                "memory",
                "mention",
                "menu",
                "mercy",
                "merge",
                "merit",
                "merry",
                "mesh",
                "message",
                "metal",
                "method",
                "middle",
                "midnight",
                "milk",
                "million",
                "mimic",
                "mind",
                "minimum",
                "minor",
                "minute",
                "miracle",
                "mirror",
                "misery",
                "miss",
                "mistake",
                "mix",
                "mixed",
                "mixture",
                "mobile",
                "model",
                "modify",
                "mom",
                "moment",
                "monitor",
                "monkey",
                "monster",
                "month",
                "moon",
                "moral",
                "more",
                "morning",
                "mosquito",
                "mother",
                "motion",
                "motor",
                "mountain",
                "mouse",
                "move",
                "movie",
                "much",
                "muffin",
                "mule",
                "multiply",
                "muscle",
                "museum",
                "mushroom",
                "music",
                "must",
                "mutual",
                "myself",
                "mystery",
                "myth",
                "naive",
                "name",
                "napkin",
                "narrow",
                "nasty",
                "nation",
                "nature",
                "near",
                "neck",
                "need",
                "negative",
                "neglect",
                "neither",
                "nephew",
                "nerve",
                "nest",
                "net",
                "network",
                "neutral",
                "never",
                "news",
                "next",
                "nice",
                "night",
                "noble",
                "noise",
                "nominee",
                "noodle",
                "normal",
                "north",
                "nose",
                "notable",
                "note",
                "nothing",
                "notice",
                "novel",
                "now",
                "nuclear",
                "number",
                "nurse",
                "nut",
                "oak",
                "obey",
                "object",
                "oblige",
                "obscure",
                "observe",
                "obtain",
                "obvious",
                "occur",
                "ocean",
                "october",
                "odor",
                "off",
                "offer",
                "office",
                "often",
                "oil",
                "okay",
                "old",
                "olive",
                "olympic",
                "omit",
                "once",
                "one",
                "onion",
                "online",
                "only",
                "open",
                "opera",
                "opinion",
                "oppose",
                "option",
                "orange",
                "orbit",
                "orchard",
                "order",
                "ordinary",
                "organ",
                "orient",
                "original",
                "orphan",
                "ostrich",
                "other",
                "outdoor",
                "outer",
                "output",
                "outside",
                "oval",
                "oven",
                "over",
                "own",
                "owner",
                "oxygen",
                "oyster",
                "ozone",
                "pact",
                "paddle",
                "page",
                "pair",
                "palace",
                "palm",
                "panda",
                "panel",
                "panic",
                "panther",
                "paper",
                "parade",
                "parent",
                "park",
                "parrot",
                "party",
                "pass",
                "patch",
                "path",
                "patient",
                "patrol",
                "pattern",
                "pause",
                "pave",
                "payment",
                "peace",
                "peanut",
                "pear",
                "peasant",
                "pelican",
                "pen",
                "penalty",
                "pencil",
                "people",
                "pepper",
                "perfect",
                "permit",
                "person",
                "pet",
                "phone",
                "photo",
                "phrase",
                "physical",
                "piano",
                "picnic",
                "picture",
                "piece",
                "pig",
                "pigeon",
                "pill",
                "pilot",
                "pink",
                "pioneer",
                "pipe",
                "pistol",
                "pitch",
                "pizza",
                "place",
                "planet",
                "plastic",
                "plate",
                "play",
                "please",
                "pledge",
                "pluck",
                "plug",
                "plunge",
                "poem",
                "poet",
                "point",
                "polar",
                "pole",
                "police",
                "pond",
                "pony",
                "pool",
                "popular",
                "portion",
                "position",
                "possible",
                "post",
                "potato",
                "pottery",
                "poverty",
                "powder",
                "power",
                "practice",
                "praise",
                "predict",
                "prefer",
                "prepare",
                "present",
                "pretty",
                "prevent",
                "price",
                "pride",
                "primary",
                "print",
                "priority",
                "prison",
                "private",
                "prize",
                "problem",
                "process",
                "produce",
                "profit",
                "program",
                "project",
                "promote",
                "proof",
                "property",
                "prosper",
                "protect",
                "proud",
                "provide",
                "public",
                "pudding",
                "pull",
                "pulp",
                "pulse",
                "pumpkin",
                "punch",
                "pupil",
                "puppy",
                "purchase",
                "purity",
                "purpose",
                "purse",
                "push",
                "put",
                "puzzle",
                "pyramid",
                "quality",
                "quantum",
                "quarter",
                "question",
                "quick",
                "quit",
                "quiz",
                "quote",
                "rabbit",
                "raccoon",
                "race",
                "rack",
                "radar",
                "radio",
                "rail",
                "rain",
                "raise",
                "rally",
                "ramp",
                "ranch",
                "random",
                "range",
                "rapid",
                "rare",
                "rate",
                "rather",
                "raven",
                "raw",
                "razor",
                "ready",
                "real",
                "reason",
                "rebel",
                "rebuild",
                "recall",
                "receive",
                "recipe",
                "record",
                "recycle",
                "reduce",
                "reflect",
                "reform",
                "refuse",
                "region",
                "regret",
                "regular",
                "reject",
                "relax",
                "release",
                "relief",
                "rely",
                "remain",
                "remember",
                "remind",
                "remove",
                "render",
                "renew",
                "rent",
                "reopen",
                "repair",
                "repeat",
                "replace",
                "report",
                "require",
                "rescue",
                "resemble",
                "resist",
                "resource",
                "response",
                "result",
                "retire",
                "retreat",
                "return",
                "reunion",
                "reveal",
                "review",
                "reward",
                "rhythm",
                "rib",
                "ribbon",
                "rice",
                "rich",
                "ride",
                "ridge",
                "rifle",
                "right",
                "rigid",
                "ring",
                "riot",
                "ripple",
                "risk",
                "ritual",
                "rival",
                "river",
                "road",
                "roast",
                "robot",
                "robust",
                "rocket",
                "romance",
                "roof",
                "rookie",
                "room",
                "rose",
                "rotate",
                "rough",
                "round",
                "route",
                "royal",
                "rubber",
                "rude",
                "rug",
                "rule",
                "run",
                "runway",
                "rural",
                "sad",
                "saddle",
                "sadness",
                "safe",
                "sail",
                "salad",
                "salmon",
                "salon",
                "salt",
                "salute",
                "same",
                "sample",
                "sand",
                "satisfy",
                "satoshi",
                "sauce",
                "sausage",
                "save",
                "say",
                "scale",
                "scan",
                "scare",
                "scatter",
                "scene",
                "scheme",
                "school",
                "science",
                "scissors",
                "scorpion",
                "scout",
                "scrap",
                "screen",
                "script",
                "scrub",
                "sea",
                "search",
                "season",
                "seat",
                "second",
                "secret",
                "section",
                "security",
                "seed",
                "seek",
                "segment",
                "select",
                "sell",
                "seminar",
                "senior",
                "sense",
                "sentence",
                "series",
                "service",
                "session",
                "settle",
                "setup",
                "seven",
                "shadow",
                "shaft",
                "shallow",
                "share",
                "shed",
                "shell",
                "sheriff",
                "shield",
                "shift",
                "shine",
                "ship",
                "shiver",
                "shock",
                "shoe",
                "shoot",
                "shop",
                "short",
                "shoulder",
                "shove",
                "shrimp",
                "shrug",
                "shuffle",
                "shy",
                "sibling",
                "sick",
                "side",
                "siege",
                "sight",
                "sign",
                "silent",
                "silk",
                "silly",
                "silver",
                "similar",
                "simple",
                "since",
                "sing",
                "siren",
                "sister",
                "situate",
                "six",
                "size",
                "skate",
                "sketch",
                "ski",
                "skill",
                "skin",
                "skirt",
                "skull",
                "slab",
                "slam",
                "sleep",
                "slender",
                "slice",
                "slide",
                "slight",
                "slim",
                "slogan",
                "slot",
                "slow",
                "slush",
                "small",
                "smart",
                "smile",
                "smoke",
                "smooth",
                "snack",
                "snake",
                "snap",
                "sniff",
                "snow",
                "soap",
                "soccer",
                "social",
                "sock",
                "soda",
                "soft",
                "solar",
                "soldier",
                "solid",
                "solution",
                "solve",
                "someone",
                "song",
                "soon",
                "sorry",
                "sort",
                "soul",
                "sound",
                "soup",
                "source",
                "south",
                "space",
                "spare",
                "spatial",
                "spawn",
                "speak",
                "special",
                "speed",
                "spell",
                "spend",
                "sphere",
                "spice",
                "spider",
                "spike",
                "spin",
                "spirit",
                "split",
                "spoil",
                "sponsor",
                "spoon",
                "sport",
                "spot",
                "spray",
                "spread",
                "spring",
                "spy",
                "square",
                "squeeze",
                "squirrel",
                "stable",
                "stadium",
                "staff",
                "stage",
                "stairs",
                "stamp",
                "stand",
                "start",
                "state",
                "stay",
                "steak",
                "steel",
                "stem",
                "step",
                "stereo",
                "stick",
                "still",
                "sting",
                "stock",
                "stomach",
                "stone",
                "stool",
                "story",
                "stove",
                "strategy",
                "street",
                "strike",
                "strong",
                "struggle",
                "student",
                "stuff",
                "stumble",
                "style",
                "subject",
                "submit",
                "subway",
                "success",
                "such",
                "sudden",
                "suffer",
                "sugar",
                "suggest",
                "suit",
                "summer",
                "sun",
                "sunny",
                "sunset",
                "super",
                "supply",
                "supreme",
                "sure",
                "surface",
                "surge",
                "surprise",
                "surround",
                "survey",
                "suspect",
                "sustain",
                "swallow",
                "swamp",
                "swap",
                "swarm",
                "swear",
                "sweet",
                "swift",
                "swim",
                "swing",
                "switch",
                "sword",
                "symbol",
                "symptom",
                "syrup",
                "system",
                "table",
                "tackle",
                "tag",
                "tail",
                "talent",
                "talk",
                "tank",
                "tape",
                "target",
                "task",
                "taste",
                "tattoo",
                "taxi",
                "teach",
                "team",
                "tell",
                "ten",
                "tenant",
                "tennis",
                "tent",
                "term",
                "test",
                "text",
                "thank",
                "that",
                "theme",
                "then",
                "theory",
                "there",
                "they",
                "thing",
                "this",
                "thought",
                "three",
                "thrive",
                "throw",
                "thumb",
                "thunder",
                "ticket",
                "tide",
                "tiger",
                "tilt",
                "timber",
                "time",
                "tiny",
                "tip",
                "tired",
                "tissue",
                "title",
                "toast",
                "tobacco",
                "today",
                "toddler",
                "toe",
                "together",
                "toilet",
                "token",
                "tomato",
                "tomorrow",
                "tone",
                "tongue",
                "tonight",
                "tool",
                "tooth",
                "top",
                "topic",
                "topple",
                "torch",
                "tornado",
                "tortoise",
                "toss",
                "total",
                "tourist",
                "toward",
                "tower",
                "town",
                "toy",
                "track",
                "trade",
                "traffic",
                "tragic",
                "train",
                "transfer",
                "trap",
                "trash",
                "travel",
                "tray",
                "treat",
                "tree",
                "trend",
                "trial",
                "tribe",
                "trick",
                "trigger",
                "trim",
                "trip",
                "trophy",
                "trouble",
                "truck",
                "TRUE",
                "truly",
                "trumpet",
                "trust",
                "truth",
                "try",
                "tube",
                "tuition",
                "tumble",
                "tuna",
                "tunnel",
                "turkey",
                "turn",
                "turtle",
                "twelve",
                "twenty",
                "twice",
                "twin",
                "twist",
                "two",
                "type",
                "typical",
                "ugly",
                "umbrella",
                "unable",
                "unaware",
                "uncle",
                "uncover",
                "under",
                "undo",
                "unfair",
                "unfold",
                "unhappy",
                "uniform",
                "unique",
                "unit",
                "universe",
                "unknown",
                "unlock",
                "until",
                "unusual",
                "unveil",
                "update",
                "upgrade",
                "uphold",
                "upon",
                "upper",
                "upset",
                "urban",
                "urge",
                "usage",
                "use",
                "used",
                "useful",
                "useless",
                "usual",
                "utility",
                "vacant",
                "vacuum",
                "vague",
                "valid",
                "valley",
                "valve",
                "van",
                "vanish",
                "vapor",
                "various",
                "vast",
                "vault",
                "vehicle",
                "velvet",
                "vendor",
                "venture",
                "venue",
                "verb",
                "verify",
                "version",
                "very",
                "vessel",
                "veteran",
                "viable",
                "vibrant",
                "vicious",
                "victory",
                "video",
                "view",
                "village",
                "vintage",
                "violin",
                "virtual",
                "virus",
                "visa",
                "visit",
                "visual",
                "vital",
                "vivid",
                "vocal",
                "voice",
                "void",
                "volcano",
                "volume",
                "vote",
                "voyage",
                "wage",
                "wagon",
                "wait",
                "walk",
                "wall",
                "walnut",
                "want",
                "warfare",
                "warm",
                "warrior",
                "wash",
                "wasp",
                "waste",
                "water",
                "wave",
                "way",
                "wealth",
                "weapon",
                "wear",
                "weasel",
                "weather",
                "web",
                "wedding",
                "weekend",
                "weird",
                "welcome",
                "west",
                "wet",
                "whale",
                "what",
                "wheat",
                "wheel",
                "when",
                "where",
                "whip",
                "whisper",
                "wide",
                "width",
                "wife",
                "wild",
                "will",
                "win",
                "window",
                "wine",
                "wing",
                "wink",
                "winner",
                "winter",
                "wire",
                "wisdom",
                "wise",
                "wish",
                "witness",
                "wolf",
                "woman",
                "wonder",
                "wood",
                "wool",
                "word",
                "work",
                "world",
                "worry",
                "worth",
                "wrap",
                "wreck",
                "wrestle",
                "wrist",
                "write",
                "wrong",
                "yard",
                "year",
                "yellow",
                "you",
                "young",
                "youth",
                "zebra",
                "zero",
                "zone",
                "zoo"
            ];

            const BIP39_WORDLIST =
                Array.isArray(window.GRIFORTIS_BIP39_WORDLIST) && window.GRIFORTIS_BIP39_WORDLIST.length
                    ? window.GRIFORTIS_BIP39_WORDLIST
                    : BUILTIN_BIP39_WORDLIST;

            const state = {
                locale: DEFAULT_LOCALE,
                generatedShares: null,
                debugPolynomials: [],
                fallbackWordMap: new Map(),
                fallbackCounter: 0,
                wordlistLoaded: BIP39_WORDLIST.length === 2048,
                recoveryShareCount: 3
            };

            const dom = {};

            document.addEventListener("DOMContentLoaded", () => {
                cacheDomReferences();
                applyTranslations();
                attachEventListeners();
                renderRecoveryShareInputs(); // default cards
                updateWordlistStatusMessage();
            });

            // Cache frequently accessed DOM nodes so we only traverse the tree once.
            function cacheDomReferences() {
                dom.themeToggle = document.getElementById("themeToggle");
                dom.toggleIcon = document.getElementById("toggle-icon");
                dom.toggleText = document.getElementById("toggle-text");
                dom.languageSelect = document.getElementById("languageSelect");
                dom.shardingForm = document.getElementById("shardingForm");
                dom.mnemonicInput = document.getElementById("mnemonicInput");
                dom.mnemonicLength = document.getElementById("mnemonicLength");
                dom.schemeSelect = document.getElementById("schemeSelect");
                dom.walletName = document.getElementById("walletName");
                dom.creationDate = document.getElementById("creationDate");
                dom.printButton = document.getElementById("printButton");
                dom.shardingMessages = document.getElementById("shardingMessages");
                dom.shareResults = document.getElementById("shareResults");
                dom.debugSection = document.getElementById("debugCoefficientsSection");
                dom.debugCoefficients = document.getElementById("debugCoefficients");
                dom.recoveryForm = document.getElementById("recoveryForm");
                dom.recoveryMnemonicLength = document.getElementById("recoveryMnemonicLength");
                dom.recoverySchemeSelect = document.getElementById("recoverySchemeSelect");
                dom.recoveryShareCountSelect = document.getElementById("recoveryShareCount");
                dom.recoverySharesContainer = document.getElementById("recoverySharesContainer");
                dom.recoveryMessages = document.getElementById("recoveryMessages");
                dom.recoveredMnemonic = document.getElementById("recoveredMnemonic");
                dom.clearRecoveryBtn = document.getElementById("clearRecoveryBtn");
                dom.runSelfTestBtn = document.getElementById("runSelfTestBtn");
                dom.selfTestOutput = document.getElementById("selfTestOutput");
                dom.toggleDebugBtn = document.getElementById("toggleDebugBtn");
            }

            // Wire every interaction for the sharding, recovery, and diagnostics workflows.
            function attachEventListeners() {
                dom.themeToggle.addEventListener("click", toggleTheme);
                dom.languageSelect.addEventListener("change", handleLanguageChange);
                dom.shardingForm.addEventListener("submit", handleGenerateShares);
                dom.printButton.addEventListener("click", () => window.print());
                dom.recoveryForm.addEventListener("submit", handleRecoverySubmission);
                dom.recoveryMnemonicLength.addEventListener("change", renderRecoveryShareInputs);
                dom.recoverySchemeSelect.addEventListener("change", adjustRecoveryShareCountOptions);
                dom.recoveryShareCountSelect.addEventListener("change", () => {
                    state.recoveryShareCount = Number(dom.recoveryShareCountSelect.value);
                    renderRecoveryShareInputs();
                });
                dom.clearRecoveryBtn.addEventListener("click", () => {
                    renderRecoveryShareInputs();
                    clearAlerts(dom.recoveryMessages);
                    dom.recoveredMnemonic.innerHTML = "";
                });
                dom.runSelfTestBtn.addEventListener("click", runSelfTest);
                dom.toggleDebugBtn.addEventListener("click", () => {
                    dom.debugSection.classList.toggle("hidden");
                });
            }

            // Mirror the design-system theme toggle from Exemplo_Form.
            function toggleTheme() {
                const body = document.body;
                const isLight = body.getAttribute("data-theme") === "light";
                if (isLight) {
                    body.removeAttribute("data-theme");
                    dom.toggleIcon.textContent = "☀️";
                    dom.toggleText.textContent = t("header.themeToggle.light");
                } else {
                    body.setAttribute("data-theme", "light");
                    dom.toggleIcon.textContent = "🌙";
                    dom.toggleText.textContent = t("header.themeToggle.dark");
                }
            }

            // Future multi-language support hooks into this dropdown.
            function handleLanguageChange() {
                const newLocale = dom.languageSelect.value;
                if (LOCALES[newLocale]) {
                    state.locale = newLocale;
                    applyTranslations();
                    document.documentElement.lang = newLocale;
                    updateWordlistStatusMessage();
                }
            }

            // Replace the text content of every element tagged with data-i18n.
            function applyTranslations() {
                const elements = document.querySelectorAll("[data-i18n]");
                elements.forEach((element) => {
                    const key = element.getAttribute("data-i18n");
                    const translation = t(key);
                    if (translation) {
                        element.textContent = translation;
                    }
                });
            }

            function t(key) {
                const messages = LOCALES[state.locale] || {};
                return messages[key] || key;
            }

            // Simple helper for consistent alert styling.
            function showAlert(container, message, type = "error") {
                const alert = document.createElement("div");
                alert.className = `alert alert-${type === "success" ? "success" : "error"}`;
                alert.textContent = message;
                container.appendChild(alert);
            }

            // Remove every alert node inside a container.
            function clearAlerts(container) {
                container.innerHTML = "";
            }

            // Warn loudly when the canonical BIP39 wordlist is missing.
            function updateWordlistStatusMessage() {
                clearAlerts(dom.shardingMessages);
                if (!state.wordlistLoaded) {
                    showAlert(
                        dom.shardingMessages,
                        "BIP39 wordlist placeholder in use. Insert the official list into window.GRIFORTIS_BIP39_WORDLIST before production use.",
                        "error"
                    );
                }
            }

            // Normalize user input into a clean array of lowercase words.
            function normalizeMnemonic(text) {
                return text
                    .trim()
                    .toLowerCase()
                    .split(/[\s\n\r]+/)
                    .filter(Boolean);
            }

            // Map mnemonic words to indices, falling back to deterministic placeholders when needed.
            function mapWordsToIndices(words) {
                if (state.wordlistLoaded) {
                    return words.map((word) => {
                        const idx = BIP39_WORDLIST.indexOf(word);
                        if (idx === -1) {
                            throw new Error(`Word "${word}" is not in the BIP39 list.`);
                        }
                        return idx;
                    });
                }

                // Placeholder mode for development: allow numeric tokens or assign deterministic indices.
                const indices = words.map((word) => {
                    if (/^\d+$/.test(word)) {
                        const numeric = Number(word);
                        if (Number.isNaN(numeric) || numeric < 0 || numeric >= PRIME) {
                            throw new Error(`Invalid numeric placeholder "${word}". Values must be between 0 and ${PRIME - 1}.`);
                        }
                        return numeric;
                    }
                    if (!state.fallbackWordMap.has(word)) {
                        state.fallbackWordMap.set(word, state.fallbackCounter % PRIME);
                        state.fallbackCounter += 1;
                    }
                    return state.fallbackWordMap.get(word);
                });

                showAlert(
                    dom.shardingMessages,
                    "Placeholder mapping is active because the BIP39 wordlist is missing. Replace it for production use.",
                    "error"
                );

                return indices;
            }

            // Recompute the BIP39 checksum (when possible) to catch transcription errors early.
            async function validateMnemonicChecksum(indices, expectedLength) {
                if (!state.wordlistLoaded) {
                    // Without the official list we cannot meaningfully validate checksum; warn and continue.
                    return true;
                }
                if (!window.crypto || !window.crypto.subtle) {
                    showAlert(dom.shardingMessages, "Web Crypto not available; cannot validate checksum.", "error");
                    return false;
                }
                const ENT = (expectedLength / 3) * 32;
                const CS = ENT / 32;
                const bitString = indices
                    .map((index) => index.toString(2).padStart(11, "0"))
                    .join("");
                const entropyBits = bitString.slice(0, ENT);
                const checksumBits = bitString.slice(ENT);
                const entropyBytes = [];
                for (let i = 0; i < ENT; i += 8) {
                    entropyBytes.push(parseInt(entropyBits.slice(i, i + 8), 2));
                }
                const entropyBuffer = new Uint8Array(entropyBytes);
                const hashBuffer = await window.crypto.subtle.digest("SHA-256", entropyBuffer);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                const hashBits = hashArray.map((byte) => byte.toString(2).padStart(8, "0")).join("");
                const expectedChecksumBits = hashBits.slice(0, CS);
                return expectedChecksumBits === checksumBits;
            }

            // Split the secret vector into rows of three words, matching the worksheet layout.
            function chunkIntoRows(values) {
                const rows = [];
                for (let i = 0; i < values.length; i += 3) {
                    rows.push(values.slice(i, i + 3));
                }
                return rows;
            }

            // Canonical reduction helper for GF(2053).
            function mod(value) {
                const result = value % PRIME;
                return result < 0 ? result + PRIME : result;
            }

            // Multiplicative inverse using the extended Euclidean algorithm.
            function modInverse(value) {
                const a = mod(value);
                if (a === 0) {
                    throw new Error("Attempted to invert zero in GF(2053).");
                }
                // Extended Euclidean Algorithm
                let t = 0,
                    newT = 1;
                let r = PRIME,
                    newR = a;
                while (newR !== 0) {
                    const quotient = Math.floor(r / newR);
                    [t, newT] = [newT, t - quotient * newT];
                    [r, newR] = [newR, r - quotient * newR];
                }
                if (r > 1) {
                    throw new Error("Value is not invertible.");
                }
                if (t < 0) {
                    t += PRIME;
                }
                return t;
            }

            // Horner-style polynomial evaluation modulo PRIME.
            function evaluatePolynomial(coefficients, x) {
                let result = 0;
                let power = 1;
                for (const coeff of coefficients) {
                    result = mod(result + mod(coeff * power));
                    power = mod(power * x);
                }
                return result;
            }

            // Draw a random coefficient for a polynomial term.
            function randomCoefficient() {
                if (window.crypto && window.crypto.getRandomValues) {
                    const buf = new Uint32Array(1);
                    window.crypto.getRandomValues(buf);
                    return buf[0] % PRIME;
                }
                // Fallback: not cryptographically secure, but better than nothing for demos.
                return Math.floor(Math.random() * PRIME);
            }

            // Each secret gets its own random polynomial with the secret embedded as a0.
            function buildPolynomial(secretValue, threshold) {
                const coefficients = [mod(secretValue)];
                for (let i = 1; i < threshold; i += 1) {
                    coefficients.push(randomCoefficient());
                }
                return coefficients;
            }

            // Compute f(0) for an arbitrary number of shares (>= threshold) using Lagrange basis.
            function lagrangeInterpolate(shares) {
                let total = 0;
                const shareCount = shares.length;
                for (let j = 0; j < shareCount; j += 1) {
                    let numerator = 1;
                    let denominator = 1;
                    for (let m = 0; m < shareCount; m += 1) {
                        if (m === j) continue;
                        numerator = mod(numerator * shares[m].x);
                        denominator = mod(denominator * mod(shares[m].x - shares[j].x));
                    }
                    const inv = modInverse(denominator);
                    const basis = mod(numerator * inv);
                    total = mod(total + mod(shares[j].y * basis));
                }
                return total;
            }

            // Main sharding handler: validate inputs, build shares, render worksheets + debug info.
            async function handleGenerateShares(event) {
                event.preventDefault();
                clearAlerts(dom.shardingMessages);
                dom.shareResults.innerHTML = "";
                dom.debugCoefficients.innerHTML = "";
                dom.debugSection.classList.add("hidden");
                dom.printButton.disabled = true;

                try {
                    const walletName = dom.walletName.value.trim();
                    const creationDate = dom.creationDate.value;
                    const mnemonicLength = Number(dom.mnemonicLength.value);
                    const schemeKey = dom.schemeSelect.value;
                    const scheme = SCHEMES[schemeKey];
                    if (!scheme) {
                        throw new Error("Unsupported threshold scheme.");
                    }
                    const words = normalizeMnemonic(dom.mnemonicInput.value);
                    if (words.length !== mnemonicLength) {
                        throw new Error(`Expected ${mnemonicLength} words but received ${words.length}.`);
                    }
                    const indices = mapWordsToIndices(words);
                    const checksumValid = await validateMnemonicChecksum(indices, mnemonicLength);
                    if (!checksumValid) {
                        throw new Error("BIP39 checksum validation failed. Double-check the mnemonic.");
                    }

                    const rows = chunkIntoRows(indices);
                    const rowChecks = rows.map((row) => mod(row.reduce((sum, value) => sum + value, 0)));
                    const masterVerification = mod(indices.reduce((sum, value) => sum + value, 0));

                    const secrets = [];
                    indices.forEach((index, position) => {
                        secrets.push({
                            type: "word",
                            label: `Word #${position + 1}`,
                            value: index,
                            position
                        });
                    });
                    rowChecks.forEach((checksum, idx) => {
                        secrets.push({
                            type: "row",
                            label: `Row ${idx + 1} checksum`,
                            value: checksum,
                            rowIndex: idx
                        });
                    });
                    secrets.push({
                        type: "master",
                        label: "Master verification number",
                        value: masterVerification
                    });

                    const polynomials = secrets.map((secret) => ({
                        ...secret,
                        coefficients: buildPolynomial(secret.value, scheme.threshold)
                    }));

                    const shareDocuments = [];
                    for (let shareIndex = 1; shareIndex <= scheme.total; shareIndex += 1) {
                        const rowsPayload = rows.map(() => ({
                            words: Array(3).fill(null),
                            checksum: null
                        }));
                        let masterShare = null;
                        polynomials.forEach((poly) => {
                            const value = evaluatePolynomial(poly.coefficients, shareIndex);
                            if (poly.type === "word") {
                                const rowIndex = Math.floor(poly.position / 3);
                                const column = poly.position % 3;
                                rowsPayload[rowIndex].words[column] = value;
                            } else if (poly.type === "row") {
                                rowsPayload[poly.rowIndex].checksum = value;
                            } else if (poly.type === "master") {
                                masterShare = value;
                            }
                        });
                        shareDocuments.push({
                            shareIndex,
                            rows: rowsPayload,
                            masterVerificationShare: masterShare
                        });
                    }

                    state.generatedShares = {
                        walletName,
                        creationDate,
                        schemeKey,
                        scheme,
                        mnemonicLength,
                        shares: shareDocuments,
                        masterVerification
                    };
                    state.debugPolynomials = polynomials;

                    renderShareResults();
                    renderDebugPolynomials();
                    showAlert(dom.shardingMessages, "Shares generated successfully.", "success");
                    dom.printButton.disabled = false;
                } catch (error) {
                    console.error(error);
                    showAlert(dom.shardingMessages, error.message || String(error), "error");
                }
            }

            // Convert share values back to BIP39 words when possible (numbers otherwise).
            function indexToWord(index) {
                if (state.wordlistLoaded && index >= 0 && index < BIP39_WORDLIST.length) {
                    return BIP39_WORDLIST[index];
                }
                return `#${index}`;
            }

            // Render every worksheet as a print-friendly card.
            function renderShareResults() {
                dom.shareResults.innerHTML = "";
                if (!state.generatedShares) return;
                const { shares, walletName, creationDate, scheme, mnemonicLength } = state.generatedShares;
                shares.forEach((share) => {
                    const card = document.createElement("div");
                    card.className = "share-card";

                    const header = document.createElement("div");
                    header.className = "share-card-header";
                    header.innerHTML = `
                        <h3>Share #${share.shareIndex} · ${scheme.threshold}-of-${scheme.total}</h3>
                        <div>
                            <div><strong>Wallet:</strong> ${walletName || "—"}</div>
                            <div><strong>Created:</strong> ${creationDate || "—"}</div>
                            <div><strong>Mnemonic Length:</strong> ${mnemonicLength} words</div>
                            <div><strong>Master Share:</strong> ${share.masterVerificationShare}</div>
                        </div>
                    `;
                    card.appendChild(header);

                    const table = document.createElement("table");
                    table.className = "share-table mono";
                    const thead = document.createElement("thead");
                    thead.innerHTML = `
                        <tr>
                            <th>Row</th>
                            <th>Word A</th>
                            <th>Word B</th>
                            <th>Word C</th>
                            <th>Group Checksum</th>
                        </tr>
                    `;
                    table.appendChild(thead);

                    const tbody = document.createElement("tbody");
                    share.rows.forEach((row, idx) => {
                        const tr = document.createElement("tr");
                        const rowLabel = document.createElement("td");
                        rowLabel.textContent = `Row ${idx + 1}`;
                        tr.appendChild(rowLabel);
                        row.words.forEach((value) => {
                            tr.appendChild(renderValueCell(value));
                        });
                        tr.appendChild(renderValueCell(row.checksum, true));
                        tbody.appendChild(tr);
                    });
                    table.appendChild(tbody);

                    const warning = document.createElement("p");
                    warning.className = "print-note";
                    warning.textContent = "One share is never enough to recover funds. Store this worksheet separately.";

                    card.appendChild(table);
                    card.appendChild(warning);
                    dom.shareResults.appendChild(card);
                });
            }

            // Format a numeric share value with its mnemonic label.
            function renderValueCell(value, isChecksum = false) {
                const cell = document.createElement("td");
                const numeric = document.createElement("div");
                numeric.className = "value-pill";
                numeric.textContent = value;
                const mnemonicLabel = document.createElement("span");
                mnemonicLabel.className = "mnemonic-label";
                mnemonicLabel.textContent = isChecksum ? "Checksum" : indexToWord(value);
                cell.appendChild(numeric);
                cell.appendChild(mnemonicLabel);
                return cell;
            }

            // Dump every polynomial so auditors can double-check randomness during dev.
            function renderDebugPolynomials() {
                dom.debugCoefficients.innerHTML = "";
                if (!state.debugPolynomials.length) return;
                const list = document.createElement("ol");
                list.className = "mono";
                state.debugPolynomials.forEach((entry) => {
                    const item = document.createElement("li");
                    item.textContent = `${entry.label}: ${entry.coefficients.join(", ")}`;
                    list.appendChild(item);
                });
                dom.debugCoefficients.appendChild(list);
                dom.debugSection.classList.remove("hidden");
            }

            // Keep the selectable share count aligned with the current scheme.
            function adjustRecoveryShareCountOptions() {
                const scheme = SCHEMES[dom.recoverySchemeSelect.value];
                if (!scheme) return;
                dom.recoveryShareCountSelect.innerHTML = "";
                for (let count = scheme.threshold; count <= scheme.total; count += 1) {
                    const option = document.createElement("option");
                    option.value = count;
                    option.textContent = count;
                    dom.recoveryShareCountSelect.appendChild(option);
                }
                dom.recoveryShareCountSelect.value = scheme.threshold;
                state.recoveryShareCount = scheme.threshold;
                renderRecoveryShareInputs();
            }

            // Build k share input cards with room for row data and master shares.
            function renderRecoveryShareInputs() {
                dom.recoverySharesContainer.innerHTML = "";
                const rowCount = Number(dom.recoveryMnemonicLength.value) / 3;
                for (let i = 0; i < state.recoveryShareCount; i += 1) {
                    const card = document.createElement("div");
                    card.className = "recovery-share-card";
                    card.innerHTML = `
                        <h4>Share Input #${i + 1}</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Share Number (x)</label>
                                <input type="number" min="1" max="10" class="share-index-input" required>
                            </div>
                            <div class="form-group">
                                <label>Master Verification Share</label>
                                <input type="number" min="0" max="${PRIME - 1}" class="share-master-input" required>
                            </div>
                        </div>
                        <label>Row Values (one row per line; 4 numbers each)</label>
                        <textarea class="recovery-textarea" placeholder="w1 w2 w3 checksum"></textarea>
                        <p class="print-note">Expected ${rowCount} lines. Use spaces or commas between numbers.</p>
                    `;
                    dom.recoverySharesContainer.appendChild(card);
                }
            }

            // Parse one share textarea into structured row tuples.
            function parseRecoveryTextarea(text, rowCount) {
                const rows = text
                    .trim()
                    .split(/\n+/)
                    .map((line) => line.trim())
                    .filter(Boolean);
                if (rows.length !== rowCount) {
                    throw new Error(`Expected ${rowCount} rows of share data but received ${rows.length}.`);
                }
                return rows.map((line, idx) => {
                    const tokens = line.split(/[\s,]+/).filter(Boolean);
                    if (tokens.length < 4) {
                        throw new Error(`Row ${idx + 1} must contain four numbers.`);
                    }
                    const values = tokens.slice(0, 4).map((token) => {
                        const value = Number(token);
                        if (Number.isNaN(value)) {
                            throw new Error(`Invalid number "${token}" in row ${idx + 1}.`);
                        }
                        return mod(value);
                    });
                    return {
                        words: values.slice(0, 3),
                        checksum: values[3]
                    };
                });
            }

            // Gather every share card into a format suitable for interpolation.
            function collectRecoveryShares(rowCount) {
                const cards = dom.recoverySharesContainer.querySelectorAll(".recovery-share-card");
                const shares = [];
                cards.forEach((card) => {
                    const shareIndexInput = card.querySelector(".share-index-input");
                    const masterInput = card.querySelector(".share-master-input");
                    const textarea = card.querySelector(".recovery-textarea");
                    const shareIndex = Number(shareIndexInput.value);
                    const masterShare = Number(masterInput.value);
                    if (!shareIndex || Number.isNaN(shareIndex)) {
                        throw new Error("Every share entry must include a share number.");
                    }
                    if (Number.isNaN(masterShare)) {
                        throw new Error("Every share entry must include the master verification share.");
                    }
                    const rows = parseRecoveryTextarea(textarea.value, rowCount);
                    shares.push({
                        shareIndex,
                        masterShare: mod(masterShare),
                        rows
                    });
                });
                return shares;
            }

            // Generic wrapper to interpolate an arbitrary secret (word, checksum, master).
            function interpolateSecret(shares, extractor) {
                const points = shares.map((share) => ({
                    x: share.shareIndex,
                    y: extractor(share)
                }));
                return lagrangeInterpolate(points);
            }

            // Convenience helper for row-level checksum recomputation.
            function computeRowChecksum(rowValues) {
                return mod(rowValues.reduce((sum, value) => sum + value, 0));
            }

            // Display the reconstructed mnemonic or highlight any outstanding issues.
            function renderRecoveredMnemonic(words, issues) {
                dom.recoveredMnemonic.innerHTML = "";
                if (issues.length) {
                    const issueList = document.createElement("ul");
                    issues.forEach((issue) => {
                        const li = document.createElement("li");
                        li.textContent = issue;
                        issueList.appendChild(li);
                    });
                    dom.recoveredMnemonic.appendChild(issueList);
                    return;
                }

                const banner = document.createElement("div");
                banner.className = "alert alert-success";
                banner.textContent = "All checksum tests passed. The mnemonic below is ready for verification.";
                dom.recoveredMnemonic.appendChild(banner);

                const grid = document.createElement("div");
                grid.className = "mnemonic-output";
                words.forEach((word, idx) => {
                    const cell = document.createElement("div");
                    cell.className = "mnemonic-word";
                    cell.textContent = `${idx + 1}. ${indexToWord(word)}`;
                    grid.appendChild(cell);
                });
                dom.recoveredMnemonic.appendChild(grid);
            }

            // Recovery flow: parse share data, reconstruct secrets, and validate checksums.
            function handleRecoverySubmission(event) {
                event.preventDefault();
                clearAlerts(dom.recoveryMessages);
                dom.recoveredMnemonic.innerHTML = "";
                try {
                    const mnemonicLength = Number(dom.recoveryMnemonicLength.value);
                    const rowCount = mnemonicLength / 3;
                    const scheme = SCHEMES[dom.recoverySchemeSelect.value];
                    if (!scheme) {
                        throw new Error("Unsupported scheme.");
                    }
                    if (state.recoveryShareCount < scheme.threshold) {
                        throw new Error(`Provide at least ${scheme.threshold} shares for this scheme.`);
                    }
                    const shares = collectRecoveryShares(rowCount);
                    if (shares.length < scheme.threshold) {
                        throw new Error(`Provide at least ${scheme.threshold} shares.`);
                    }
                    const words = [];
                    for (let wordIndex = 0; wordIndex < mnemonicLength; wordIndex += 1) {
                        const rowIdx = Math.floor(wordIndex / 3);
                        const colIdx = wordIndex % 3;
                        const secret = interpolateSecret(shares, (share) => share.rows[rowIdx].words[colIdx]);
                        words.push(secret);
                    }
                    const checksumIssues = [];
                    for (let rowIdx = 0; rowIdx < rowCount; rowIdx += 1) {
                        const recoveredChecksum = interpolateSecret(shares, (share) => share.rows[rowIdx].checksum);
                        const rowWords = words.slice(rowIdx * 3, rowIdx * 3 + 3);
                        const computed = computeRowChecksum(rowWords);
                        if (computed !== recoveredChecksum) {
                            checksumIssues.push(`Row ${rowIdx + 1} checksum mismatch (computed ${computed}, expected ${recoveredChecksum}).`);
                        }
                    }
                    const recoveredMaster = interpolateSecret(shares, (share) => share.masterShare);
                    const computedMaster = mod(words.reduce((sum, value) => sum + value, 0));
                    if (computedMaster !== recoveredMaster) {
                        checksumIssues.push(`Master verification mismatch (computed ${computedMaster}, expected ${recoveredMaster}).`);
                    }

                    if (checksumIssues.length) {
                        checksumIssues.forEach((issue) => showAlert(dom.recoveryMessages, issue, "error"));
                    } else {
                        showAlert(dom.recoveryMessages, "Recovery successful. Review the mnemonic below.", "success");
                    }
                    renderRecoveredMnemonic(words, checksumIssues);
                } catch (error) {
                    showAlert(dom.recoveryMessages, error.message || String(error), "error");
                }
            }

            // Deterministic arithmetic smoke test (no wallet data touched).
            function runSelfTest() {
                const log = [];
                try {
                    const poly = [123, 456, 789]; // degree 2
                    const x = 5;
                    const value = evaluatePolynomial(poly, x);
                    log.push(`Polynomial f(x)=123 + 456x + 789x^2 evaluated at x=5 -> ${value}`);

                    const shares = [
                        { x: 1, y: evaluatePolynomial(poly, 1) },
                        { x: 3, y: evaluatePolynomial(poly, 3) },
                        { x: 7, y: evaluatePolynomial(poly, 7) }
                    ];
                    const recovered = lagrangeInterpolate(shares);
                    log.push(`Lagrange interpolation recovered f(0)=${recovered}`);
                    if (recovered !== poly[0]) {
                        throw new Error("Self-test failed: expected constant term mismatch.");
                    }
                    log.push("Self-test passed.");
                    dom.selfTestOutput.textContent = log.join("\n");
                } catch (error) {
                    log.push(`Self-test error: ${error.message || error}`);
                    dom.selfTestOutput.textContent = log.join("\n");
                }
            }
        })();
    </script>
</body>
</html>

